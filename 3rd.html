<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø«Ø§Ù„Ø«Ø© Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</title>
<style>
body { font-family: "Cairo", sans-serif; margin:0; background:#f5f6fa; color:#222; }
header { display:flex; justify-content:space-around; align-items:center; background:#0078d7; color:white; padding:15px; font-weight:bold; }
header button { background:transparent; border:none; color:white; font-size:16px; cursor:pointer; transition:0.3s; }
header button.active { border-bottom:3px solid #fff; }
main { padding:20px; }
.section { display:none; }
.section.active { display:block; }
.card { background:white; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1); padding:20px; margin-bottom:20px; position:relative; }
label { display:block; margin-bottom:6px; font-weight:bold; }
select, input[type="text"], input[type="number"] { width:100%; padding:10px; margin-bottom:15px; border:1px solid #ccc; border-radius:10px; font-size:15px; }
.radio-group { display:flex; gap:15px; margin-bottom:15px; }
.radio-group label { font-weight:normal; }
button.submit-btn { background:#0078d7; color:white; border:none; border-radius:10px; padding:10px 20px; cursor:pointer; font-size:16px; transition:0.3s; }
button.submit-btn:disabled { background:#aaa; cursor:not-allowed; }
.suggestions { position:absolute; background:white; border:1px solid #ccc; border-radius:8px; width:calc(100% - 40px); max-height:150px; overflow-y:auto; box-shadow:0 4px 8px rgba(0,0,0,0.15); z-index:10; }
.suggestions div { padding:8px; cursor:pointer; transition:0.2s; }
.suggestions div:hover { background:#0078d7; color:white; }
table { border-collapse: collapse; width: 100%; margin-top: 10px; }
table, th, td { border: 1px solid #ccc; }
th, td { padding: 8px; text-align: center; }
th { background: #0078d7; color: white; }
@media (max-width:600px) { .card { padding:15px; } }
</style>
</head>
<body>
<header>
<button id="attendanceTab" class="active">ğŸ“‹ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</button>
<button id="reportsTab">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
</header>

<main>
<section id="attendanceSection" class="section active">
  <div class="card">
    <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ù†ÙˆØªØ©</h3>
    <label>Ø§Ù„Ø³Ù†Ø©</label><select id="yearSelect"></select>
    <label>Ø§Ù„Ø´Ù‡Ø±</label><select id="monthSelect"></select>
    <label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><select id="dateSelect"></select>
    <label>Ø§Ù„Ø§Ø³Ù…</label>
    <input type="text" id="nameInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…...(Ù„Ø§Ø²Ù… Ù…Ù† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª)">
    <div id="nameSuggestions" class="suggestions" style="display:none;"></div>
    <label>Ø§Ù„Ø­Ø¶ÙˆØ±</label>
    <div class="radio-group">
      <label><input type="radio" name="attendance" value="Ø­Ø¶Ø±"> Ø­Ø¶Ø±</label>
      <label><input type="radio" name="attendance" value="ØºØ§Ø¨"> ØºØ§Ø¨</label>
    </div>
    <label>Ø¬Ø§Ø¨ Ø§Ù„Ù†ÙˆØªØ©ØŸ</label>
    <div class="radio-group">
      <label><input type="radio" name="notebook" value="Ù†Ø¹Ù…"> Ù†Ø¹Ù…</label>
      <label><input type="radio" name="notebook" value="Ù„Ø§"> Ù„Ø§</label>
    </div>
    <button id="attendanceSubmit" class="submit-btn" disabled>Ø¥Ø±Ø³Ø§Ù„</button>
  </div>

  <div class="card">
    <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙØ§Ø¹Ù„</h3>
    <label>Ø§Ù„Ø§Ø³Ù…</label>
    <input type="text" id="interactionName" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…...">
    <div id="interactionSuggestions" class="suggestions" style="display:none;"></div>
    <label>Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙØ§Ø¹Ù„ (0 - 5)</label>
    <input type="number" id="interactionPoints" min="0" max="5">
    <button id="interactionSubmit" class="submit-btn" disabled>Ø¥Ø±Ø³Ø§Ù„</button>
  </div>
</section>

<section id="reportsSection" class="section">
  <div class="card">
    <h3>Ø£Ø¹ÙŠØ§Ø¯ Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„</h3>
    <label>Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</label><select id="birthdayMonth"></select>
    <button id="birthdayShow" class="submit-btn">Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</button>
    <div id="birthdayResult"></div>
  </div>

  <div class="card">
    <h3>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ±</h3>
    <label>Ø§Ù„Ø³Ù†Ø©</label><select id="reportYear"></select>
    <label>Ø§Ù„Ø´Ù‡Ø±</label><select id="reportMonth"></select>
    <label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><select id="reportDate"></select>
    <button id="showCount" class="submit-btn">Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
    <button id="showNames" class="submit-btn">Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</button>
    <div id="attendanceReportResult"></div>
  </div>

  <div class="card">
    <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·ÙÙ„</h3>
    <label>Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="childInfoName" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…...">
    <div id="childInfoSuggestions" class="suggestions" style="display:none;"></div>
    <button id="showChildInfo" class="submit-btn">Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    <div id="childInfoResult"></div>
  </div>

  <div class="card">
    <h3>Ø­Ø¶ÙˆØ± Ø§Ù„Ø·ÙÙ„ ÙÙŠ Ø§Ù„Ø´Ù‡Ø±</h3>
    <label>Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="childAttendanceName" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…...">
    <div id="childAttendanceSuggestions" class="suggestions" style="display:none;"></div>
    <label>Ø§Ù„Ø³Ù†Ø©</label><select id="childAttendanceYear"></select>
    <label>Ø§Ù„Ø´Ù‡Ø±</label><select id="childAttendanceMonth"></select>
    <button id="showChildAttendance" class="submit-btn">Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
    <div id="childAttendanceResult"></div>
  </div>

  <div class="card">
    <h3>Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h3>
    <label>Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="interactionReportName" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…...">
    <div id="interactionReportSuggestions" class="suggestions" style="display:none;"></div>
    <label>Ø§Ù„Ø³Ù†Ø©</label><select id="interactionReportYear"></select>
    <label>Ø§Ù„Ø´Ù‡Ø±</label><select id="interactionReportMonth"></select>
    <button id="showInteractionReport" class="submit-btn">Ø¹Ø±Ø¶ Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙØ§Ø¹Ù„</button>
    <div id="interactionReportResult"></div>
  </div>
</section>
</main>

<script>
// --- Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ---
const attendanceTab = document.getElementById("attendanceTab");
const reportsTab = document.getElementById("reportsTab");
const attendanceSection = document.getElementById("attendanceSection");
const reportsSection = document.getElementById("reportsSection");

attendanceTab.onclick = () => {
  attendanceTab.classList.add("active");
  reportsTab.classList.remove("active");
  attendanceSection.classList.add("active");
  reportsSection.classList.remove("active");
};
reportsTab.onclick = () => {
  reportsTab.classList.add("active");
  attendanceTab.classList.remove("active");
  reportsSection.classList.add("active");
  attendanceSection.classList.remove("active");
};

// --- ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø³Ù†ÙˆØ§Øª ÙˆØ§Ù„Ø´Ù‡ÙˆØ± ---
const yearSelect = document.getElementById("yearSelect");
const monthSelect = document.getElementById("monthSelect");
const dateSelect = document.getElementById("dateSelect");
const currentYear = new Date().getFullYear();
for(let y=currentYear-1;y<=currentYear+1;y++){
  const opt=document.createElement("option"); opt.value=y; opt.textContent=y;
  yearSelect.appendChild(opt);
}
const months=["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"];
months.forEach((m,i)=>{ const opt=document.createElement("option"); opt.value=i+1; opt.textContent=m; monthSelect.appendChild(opt); });

function fillFridays() {
  dateSelect.innerHTML="";
  const year=+yearSelect.value;
  const month=+monthSelect.value-1;
  const daysInMonth=new Date(year,month+1,0).getDate();
  for(let d=1;d<=daysInMonth;d++){
    const date=new Date(year,month,d);
    if(date.getDay()===5){
      const opt=document.createElement("option"); opt.value=d; opt.textContent=`${d}/${month+1}/${year}`;
      dateSelect.appendChild(opt);
    }
  }
}
yearSelect.onchange=fillFridays;
monthSelect.onchange=fillFridays;
fillFridays();

// --- Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ---
let allNames=[];
const apiURL="https://3rd.johnmamdouh777.workers.dev/";

async function loadNames(){
  try{
    const res = await fetch(apiURL+"?type=names");
    const data = await res.json();
    allNames = Array.isArray(data)?data:data.names||[];
  }catch(err){ console.warn(err); }
}
loadNames();

function setupSuggestions(inputEl,suggestionsEl){
  inputEl.addEventListener("input",()=>{
    const q=inputEl.value.trim();
    if(!q) return (suggestionsEl.style.display="none");
    const filtered=allNames.filter(n=>n.includes(q)).slice(0,10);
    if(filtered.length===0){ suggestionsEl.style.display="none"; return; }
    suggestionsEl.innerHTML="";
    filtered.forEach(name=>{
      const div=document.createElement("div"); div.textContent=name;
      div.onclick=()=>{ inputEl.value=name; suggestionsEl.style.display="none"; inputEl.dispatchEvent(new Event("input")); };
      suggestionsEl.appendChild(div);
    });
    suggestionsEl.style.display="block";
  });
  document.addEventListener("click",(e)=>{
    if(!inputEl.contains(e.target)&&!suggestionsEl.contains(e.target)) suggestionsEl.style.display="none";
  });
}
setupSuggestions(document.getElementById("nameInput"),document.getElementById("nameSuggestions"));
setupSuggestions(document.getElementById("interactionName"),document.getElementById("interactionSuggestions"));
setupSuggestions(document.getElementById("childInfoName"),document.getElementById("childInfoSuggestions"));
setupSuggestions(document.getElementById("childAttendanceName"),document.getElementById("childAttendanceSuggestions"));
setupSuggestions(document.getElementById("interactionReportName"),document.getElementById("interactionReportSuggestions"));

// --- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ---
const attendanceSubmit=document.getElementById("attendanceSubmit");
const interactionSubmit=document.getElementById("interactionSubmit");
const interactionName=document.getElementById("interactionName");
const interactionPoints=document.getElementById("interactionPoints");

// Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙƒØ±Ø§Ø±
attendanceSubmit.addEventListener("click", async () => {
  const name = document.getElementById("nameInput").value.trim();
  const attendance = document.querySelector('input[name="attendance"]:checked').value;
  const notebook = document.querySelector('input[name="notebook"]:checked').value;
  const date = dateSelect.options[dateSelect.selectedIndex].text;
  const year = yearSelect.value;
  const month = monthSelect.value;

  // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  try {
    const checkRes = await fetch(apiURL + `?type=checkAttendance&name=${encodeURIComponent(name)}&year=${year}&month=${month}&date=${encodeURIComponent(date)}`);
    const checkData = await checkRes.json();
    if (checkData.exists) {
      alert(`âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©: ${name} Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….`);
      return;
    }
  } catch {
    alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¶ÙˆØ±.");
    return;
  }

  attendanceSubmit.disabled = true;
  const data = { type: "attendance", year, month, date, name, attendance, notebook };
  try {
    const res = await fetch(apiURL, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(data) });
    const result = await res.json();
    if (result.success) {
      alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!");
      document.getElementById("nameInput").value = "";
      document.querySelectorAll('input[name="attendance"]').forEach(e => e.checked = false);
      document.querySelectorAll('input[name="notebook"]').forEach(e => e.checked = false);
      checkAttendanceReady();
    } else alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„.");
  } catch {
    alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….");
  } finally { attendanceSubmit.disabled = false; }
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙØ§Ø¹Ù„
function checkInteractionReady() {
  const name = interactionName.value.trim();
  const points = Number(interactionPoints.value);
  const validName = allNames.includes(name);
  const validPoints = !isNaN(points) && points >= 0 && points <= 5;
  interactionSubmit.disabled = !(name && validPoints && validName);
}
interactionName.addEventListener("input", checkInteractionReady);
interactionPoints.addEventListener("input", checkInteractionReady);

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
interactionSubmit.addEventListener("click", async () => {
  const name = interactionName.value.trim();
  const points = Number(interactionPoints.value);

  // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù†Ù‚Ø§Ø·
  if (points < 0 || points > 5) {
    alert("âŒ Ø§Ù„Ù†Ù‚Ø§Ø· ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 0 Ùˆ 5.");
    return;
  }

  try {
    const checkRes = await fetch(apiURL + `?type=checkInteraction&name=${encodeURIComponent(name)}`);
    const checkData = await checkRes.json();
    if (checkData.exists) {
      alert(`âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ù„Ù€ ${name}.`);
      return;
    }
  } catch {
    alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙØ§Ø¹Ù„.");
    return;
  }

  interactionSubmit.disabled = true;
  const data = { type: "interaction", name, points };
  try {
    const res = await fetch(apiURL, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(data) });
    const result = await res.json();
    if (result.success) {
      alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø¨Ù†Ø¬Ø§Ø­!");
      interactionName.value = "";
      interactionPoints.value = "";
      checkInteractionReady();
    } else alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„.");
  } catch {
    alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….");
  } finally { interactionSubmit.disabled = false; }
});

// --- Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ---
const birthdayMonth=document.getElementById("birthdayMonth");
const reportYear=document.getElementById("reportYear");
const reportMonth=document.getElementById("reportMonth");
const reportDate=document.getElementById("reportDate");
const childAttendanceYear=document.getElementById("childAttendanceYear");
const childAttendanceMonth=document.getElementById("childAttendanceMonth");
const interactionReportYear=document.getElementById("interactionReportYear");
const interactionReportMonth=document.getElementById("interactionReportMonth");

[reportYear,childAttendanceYear,interactionReportYear].forEach(sel=>{
  for(let y=currentYear-1;y<=currentYear+1;y++){
    const opt=document.createElement("option"); opt.value=y; opt.textContent=y; sel.appendChild(opt);
  }
});
months.forEach((m,i)=>{
  const opt1=document.createElement("option"); opt1.value=i+1; opt1.textContent=m; reportMonth.appendChild(opt1);
  const opt2=document.createElement("option"); opt2.value=i+1; opt2.textContent=m; childAttendanceMonth.appendChild(opt2);
  const opt3=document.createElement("option"); opt3.value=i+1; opt3.textContent=m; interactionReportMonth.appendChild(opt3);
  const optB=document.createElement("option"); optB.value=i+1; optB.textContent=m; birthdayMonth.appendChild(optB);
});

// --- Ù…Ù„Ø¡ Ø£ÙŠØ§Ù… Ø§Ù„Ø¬Ù…Ø¹Ø© Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ---
function fillReportFridays(){
  reportDate.innerHTML="";
  const year=+reportYear.value;
  const month=+reportMonth.value-1;
  const daysInMonth=new Date(year,month+1,0).getDate();
  for(let d=1;d<=daysInMonth;d++){
    const date=new Date(year,month,d);
    if(date.getDay()===5){ const opt=document.createElement("option"); opt.value=d; opt.textContent=`${d}/${month+1}/${year}`; reportDate.appendChild(opt); }
  }
}
reportYear.onchange=fillReportFridays;
reportMonth.onchange=fillReportFridays;
fillReportFridays();

// --- ØªØ¹Ø¯ÙŠÙ„ Ø·Ø±ÙŠÙ‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„ØªÙƒÙˆÙ† Ø¬Ø¯Ø§ÙˆÙ„ ---
function renderListAsTable(container, arr, colName="Ø§Ù„Ø§Ø³Ù…"){
  if(!arr || arr.length===0){ container.innerHTML="Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"; return; }
  container.innerHTML = `<table><tr><th>${colName}</th></tr>${arr.map(x=>`<tr><td>${x}</td></tr>`).join("")}</table>`;
}

function renderObjectAsTable(container, obj){
  if(!obj || Object.keys(obj).length===0){ container.innerHTML="Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"; return; }
  container.innerHTML = `<table>${Object.entries(obj).map(([k,v])=>`<tr><th>${k}</th><td>${v}</td></tr>`).join("")}</table>`;
}

function renderArrayOfObjectsAsTable(container, arr, headers){
  if(!arr || arr.length===0){ container.innerHTML="Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"; return; }
  container.innerHTML = `<table>
    <tr>${headers.map(h=>`<th>${h}</th>`).join("")}</tr>
    ${arr.map(row=>`<tr>${headers.map(h=>`<td>${row[h]||""}</td>`).join("")}</tr>`).join("")}
  </table>`;
}

// --- Ø£Ø¹ÙŠØ§Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ---
document.getElementById("birthdayShow").addEventListener("click",async()=>{
  const month=birthdayMonth.value; if(!month) return alert("Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø± Ø£ÙˆÙ„Ø§Ù‹");
  try{
    const res=await fetch(apiURL+`?type=birthday&month=${month}`);
    const data=await res.json();
    renderListAsTable(document.getElementById("birthdayResult"), data.names || [], "Ø§Ù„Ø£Ø³Ù…Ø§Ø¡");
  }catch{ alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…."); }
});

// --- Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ± ---
document.getElementById("showCount").addEventListener("click",async()=>{
  const year=reportYear.value; const month=reportMonth.value; const date=reportDate.value;
  try{
    const res=await fetch(apiURL+`?type=attendanceCount&year=${year}&month=${month}&date=${date}`);
    const data=await res.json();
    document.getElementById("attendanceReportResult").textContent=`Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ±: ${data.count||0}`;
  }catch{ alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…."); }
});

// --- Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ø¶ÙˆØ± ---
document.getElementById("showNames").addEventListener("click",async()=>{
  const year=reportYear.value; const month=reportMonth.value; const date=reportDate.value;
  try{
    const res=await fetch(apiURL+`?type=attendanceNames&year=${year}&month=${month}&date=${date}`);
    const data=await res.json();
    renderListAsTable(document.getElementById("attendanceReportResult"), data.names || [], "Ø§Ù„Ø£Ø³Ù…Ø§Ø¡");
  }catch{ alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…."); }
});

// --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·ÙÙ„ ---
document.getElementById("showChildInfo").addEventListener("click",async()=>{
  const name=document.getElementById("childInfoName").value.trim(); if(!name) return alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…");
  try{
    const res=await fetch(apiURL+`?type=childInfo&name=${name}`);
    const data=await res.json();
    renderObjectAsTable(document.getElementById("childInfoResult"), data);
  }catch{ alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…."); }
});

// --- Ø­Ø¶ÙˆØ± Ø§Ù„Ø·ÙÙ„ ÙÙŠ Ø§Ù„Ø´Ù‡Ø± ---
document.getElementById("showChildAttendance").addEventListener("click",async()=>{
  const name=document.getElementById("childAttendanceName").value.trim(); 
  const year=childAttendanceYear.value; 
  const month=childAttendanceMonth.value;
  if(!name) return alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…");
  try{
    const res=await fetch(apiURL+`?type=childAttendance&name=${name}&year=${year}&month=${month}`);
    const data=await res.json();
    renderArrayOfObjectsAsTable(document.getElementById("childAttendanceResult"), data, ["date","attendance","notebook"]);
  }catch{ alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…."); }
});

// --- Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ---
document.getElementById("showInteractionReport").addEventListener("click",async()=>{
  const name=document.getElementById("interactionReportName").value.trim(); 
  const year=interactionReportYear.value; 
  const month=interactionReportMonth.value;
  if(!name) return alert("Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…");
  try{
    const res=await fetch(apiURL+`?type=interactionReport&name=${name}&year=${year}&month=${month}`);
    const data=await res.json();
    renderArrayOfObjectsAsTable(document.getElementById("interactionReportResult"), data, ["date","points"]);
  }catch{ alert("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…."); }
});
</script>
</body>
</html>
